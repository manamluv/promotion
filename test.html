<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BLACK TAIL | 전문 퇴마사 적성 검사</title>
    <style>
        @font-face {
            font-family: 'Suit';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_suit@1.0/SUIT-Regular.woff2') format('woff2');
            font-weight: normal;
            font-display: swap;
        }

        @font-face {
            font-family: 'HeirofLightBold';
            src: url('../font/HeirofLightBold.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            }

        *{
            font-family: 'Suit', sans-serif; 
        }

        :root {
            --primary-red: #700915;
            --bg-black: #1B1B1B;
            --card-bg: #111111;
            --border-color: #2a2a2a;
            --text-gray: #888;
        }

        body {
            max-width: 480px;
            margin: 0 auto;
            min-height: 100vh;
            background-color: var(--bg-black);
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: radial-gradient(circle, #1a1a1a 1px, transparent 1px);
            background-size: 30px 30px;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
            word-break: keep-all;
        }

        .test-container {
            background: var(--card-bg);
            padding: 50px 30px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 50px rgba(0,0,0,0.8);
            text-align: center;
            width: 90%;
            max-width: 450px;
            position: relative;
            box-sizing: border-box;
        }

        .test-container::before {
            content: "";
            position: absolute;
            top: 0; left: 0; width: 100%; height: 3px;
            background: #700915;
            box-shadow: 0 0 10px #700915;
        }

        .system-header {
            font-size: 0.65rem;
            color: #700915;
            letter-spacing: 2px;
            margin-bottom: 20px;
            font-weight: 900;
            text-transform: uppercase;
        }

        h1 { 
            font-family: 'HeirofLightBold'; 
            font-size: 1.8rem; 
            margin: 0 0 10px 0; 
            font-weight: 800; 
            letter-spacing: 1.5px; 
        }

        .subtitle { 
            color: var(--text-gray); 
            font-size: 0.9rem; 
            margin-bottom: 10px; 
        }

        .progress-container { 
            margin-bottom: 40px; 
        }

        .progress-bar { 
            background: #222; 
            height: 4px; 
            border-radius: 2px; 
            width: 100%; 
        }

        #progress {
            background: #700915;
            height: 100%;
            width: 0%;
            transition: 0.4s ease-out;
            box-shadow: 0 0 10px #700915;
        }

        #question-text {
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 35px;
            min-height: 3.5em;
            word-break: keep-all;
            font-weight: 600;
        }

        .answer-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .answer-buttons button {
            display: block;
            width: 100%;
            padding: 18px;
            background: transparent;
            color: #eee;
            border: 1px solid #333;
            border-radius: 4px;
            cursor: pointer;
            font-size: clamp(0.7rem, 5vw, 0.85rem);
            font-weight: 500;
            transition: all 0.2s;
            text-align: center;
            font-family: 'Suit', sans-serif;
            outline: none;
        }

        .answer-buttons button.selected {
            background: #700915 !important;
            color: #fff !important;
            border-color: #700915 !important;
            box-shadow: 0 0 20px rgba(179, 0, 0, 0.4);
            transform: scale(0.98);
        }

        #result-title { 
            color: #700915; 
            font-size: 2.2rem; 
            font-weight: 900; 
        }

        #result-weapon { 
            font-size: 0.85rem; 
            color: #fff; 
            background: #222; 
            display: inline-block; 
            padding: 5px 12px; 
            margin-bottom: 20px; 
            border-radius: 2px; 
        }

        #result-desc { 
            color: var(--text-gray); 
            line-height: 1.7; 
            font-size: 0.95rem; 
            margin-bottom: 30px; 
            word-break: keep-all; 
        }

        .btn-action {
            background: #700915;
            color: #fff;
            border: none;
            padding: 18px;
            font-weight: bold;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            font-size: 1rem;
            transition: 0.3s;
        }

        .fade-in { 
            animation: fadeIn 0.4s ease-out forwards; 
        }
        
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(10px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div id="status-text" class="system-header">Spiritual Syncing...</div>

        <section id="start-screen">
            <h1>BLACK TAIL</h1>
            <p class="subtitle">신입 퇴마사 적성 검사 시스템</p>
            <button class="btn-action" onclick="startTest()">검사 프로세스 시작</button>
        </section>

        <section id="question-screen" style="display:none;">
            <div class="progress-container">
                <div class="progress-bar"><div id="progress"></div></div>
            </div>
            <div id="fade-wrapper">
                <h2 id="question-text">질문 내용</h2>
                <div class="answer-buttons">
                    <button id="btn-a" onclick="selectAnswer('A', this)">선택지 A</button>
                    <button id="btn-b" onclick="selectAnswer('B', this)">선택지 B</button>
                </div>
            </div>
        </section>

        <section id="result-screen" style="display:none;" class="fade-in">
            <p class="system-header">Verification Complete</p>
            <p class="subtitle">분석 결과, <span id="displayName"></span>님은</p>
            <h1 id="result-title">퇴마사 유형</h1>
            <div id="result-weapon">주력 영구(靈具): </div>
            <p id="result-desc">유형 설명</p>
            <button class="btn-action" onclick="onon()">최종지원하기</button>
        </section>
    </div>

    <script>
        const savedName = sessionStorage.getItem("applyName");
        const nameSpan = document.getElementById("displayName");

        // 데이터가 있을 때만 표시, 없으면 '지원자'로 대체
        if (savedName) {
            nameSpan.innerText = savedName;
        } else {
            nameSpan.innerText = "지원자";
        }

        // 질문 및 결과 데이터 (동일)
        const questions = [
            { q: "악령 출몰 제보를 받았다. 당신의 첫 행동은?", type: "EI", a: "동료들을 소집해 합동 퇴마팀을 구성한다.", b: "혼자 은밀하게 현장에 잠입해 동태를 살핀다." },
            { q: "퇴마 도중 민간인 구경꾼들이 현장에 난입했다.", type: "EI", a: "직접 나서서 구역을 통제하고 대피시킨다.", b: "은폐 결계를 쳐서 상황이 보이지 않게 차단한다." },
            { q: "치열한 작전 후 당신이 선호하는 휴식은?", type: "EI", a: "동료 퇴마사들과 아지트에서 맥주 한 잔", b: "개인 정비실에서 홀로 도구를 닦으며 명상" },
            { q: "악령의 정체를 분석할 때 더 신뢰하는 쪽은?", type: "SN", a: "현장에 남겨진 흔적과 과거의 퇴마 데이터", b: "공기 중의 서늘한 기운과 영적인 직감" },
            { q: "새로운 오컬트 장비를 보급받았다. 당신은?", type: "SN", a: "사용 매뉴얼을 토씨 하나 틀리지 않게 정독한다.", b: "일단 손에 쥐어보고 영력을 흘려보며 감을 잡는다." },
            { q: "작전 중 예상치 못한 기이한 현상을 마주하면?", type: "SN", a: "기록된 프로토콜에 따라 차분하게 대응한다.", b: "이 상황을 흥미로운 변수로 여기며 관찰한다." },
            { q: "원한이 깊어 이성을 잃은 악령을 마주했다.", type: "TF", a: "가차 없이 프로토콜대로 소멸 처분한다.", b: "사연을 들어보고 영혼을 달래 성불을 시도한다." },
            { q: "동료가 퇴마 실패 후 크게 낙담하고 있다면?", type: "TF", a: "냉정하게 원인을 분석하고 다음 대책을 세운다.", b: "부상이 없어 다행이라며 진심 어린 위로를 건넨다." },
            { q: "당신이 추구하는 이상적인 퇴마의 형태는?", type: "TF", a: "피해를 최소화한 효율적이고 완벽한 제압", b: "원통한 영혼의 한을 풀어주는 자비로운 구원" },
            { q: "출동 전, 당신의 전술 가방 상태는 어떠한가?", type: "JP", a: "부적과 도구가 종류별로 완벽히 정렬된 상태", b: "필요한 것을 즉석에서 찾아 쓰는 자유로운 상태" },
            { q: "목표지의 상황이 예상과 180도 다르다면?", type: "JP", a: "준비해둔 예비 작전을 즉각 가동한다.", b: "현장의 흐름에 몸을 맡기며 즉흥적으로 대응한다." },
            { q: "활동 보고서 마감 기한이 코앞으로 다가왔다.", type: "JP", a: "이미 작전 종료 직후에 작성을 끝냈다.", b: "마지막 순간에 몰입하여 한 번에 써 내려간다." }
        ];

        const results = {
            ISTJ: { title: "원칙주의 기록관", weapon: "은제 만년필", desc: "묵오단의 기록을 계승해 오차 없는 퇴마 절차를 설계하는 기록관 유형입니다." },
            ISFJ: { title: "헌신적인 가디언", weapon: "축복받은 방패", desc: "동료들이 상처받지 않게 뒤에서 묵묵히 결계를 치고 보호하는 가디언입니다." },
            INFJ: { title: "통찰하는 예언자", weapon: "수정 펜듈럼", desc: "악령의 비가시적인 이동 경로를 본능적으로 감지해 사고를 방지하는 예언자입니다." },
            INTJ: { title: "냉철한 전략가", weapon: "데이터 제어 유닛", desc: "현장 전체를 거대한 함정으로 설계해 악령을 시스템 속에 가둬 소멸시킵니다." },
            ISTP: { title: "기술직 퇴마사", weapon: "영적 에너지 단검", desc: "고장 난 영구도 현장에서 즉석 개조하여 작전을 성공시키는 무기 전문가입니다." },
            ISFP: { title: "영적 아티스트", weapon: "영력 브러쉬", desc: "부적 한 장에도 예술적인 영력을 담아내 시각적으로 압도하는 힘을 발휘합니다." },
            INFP: { title: "영혼의 구도자", weapon: "정화의 오르골", desc: "가장 사악한 영혼의 마음까지 어루만지는 깊은 공감 능력을 지닌 구도자입니다." },
            INTP: { title: "심령학자", weapon: "주파수 스캐너", desc: "귀신의 파동을 과학적으로 분석해 존재 자체를 무효화하는 효율적인 천재입니다." },
            ESTP: { title: "현장의 파괴자", weapon: "성수 산탄총", desc: "블랙테일의 대표퇴마사처럼 몸이 먼저 나갑니다. 압도적인 액션으로 악령을 정면 돌파합니다." },
            ESFP: { title: "화려한 엑소시스트", weapon: "발광하는 채찍", desc: "자신에게 시선을 집중시켜 악령을 유인하고 화려한 퍼포먼스로 현장을 장악합니다." },
            ENFP: { title: "자유로운 영매", weapon: "영혼 통신 무전기", desc: "귀신조차 친구로 만드는 특유의 친화력으로 예상치 못한 변수를 만들어냅니다." },
            ENTP: { title: "실험적 이단아", weapon: "고전압 퇴마 장치", desc: "금기시되는 퇴마 방식을 실험적으로 도입해 누구도 생각지 못한 해결책을 냅니다." },
            ESTJ: { title: "현장 총괄 사령관", weapon: "마력 확성기", desc: "현장을 일사불란하게 통제하며 팀원들을 배치해 완벽한 승리를 쟁취합니다." },
            ESFJ: { title: "팀의 마스코트", weapon: "성유 향수", desc: "팀원들의 멘탈을 관리하고 현장의 민원까지 해결하는 블랙테일의 살림꾼입니다." },
            ENFJ: { title: "여명의 리더", weapon: "정화의 지팡이", desc: "동료들에게 사기를 북돋우며 악령에 맞설 용기를 줍니다." },
            ENTJ: { title: "총괄 디렉터", weapon: "레이저 포인터", desc: "블랙테일의 승리를 위해 거대한 작전판을 설계하고 팀원들을 완벽하게 움직입니다." }
        };

        let currentIdx = 0;
        let score = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };

        function startTest() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('question-screen').style.display = 'block';
            showQuestion();
        }

        function showQuestion() {
            const q = questions[currentIdx];
            const wrapper = document.getElementById('fade-wrapper');
            
            // 모든 버튼의 선택 효과 제거 (초기화)
            document.querySelectorAll('.answer-buttons button').forEach(btn => {
                btn.classList.remove('selected');
            });

            wrapper.classList.remove('fade-in');
            void wrapper.offsetWidth; 
            wrapper.classList.add('fade-in');

            document.getElementById('question-text').innerText = q.q;
            document.getElementById('btn-a').innerText = q.a;
            document.getElementById('btn-b').innerText = q.b;
            
            document.getElementById('progress').style.width = ((currentIdx) / questions.length) * 100 + "%";
        }

        function selectAnswer(choice, btnElement) {
            // [추가] 클릭된 버튼에 선택 상태 클래스 부여
            btnElement.classList.add('selected');

            const type = questions[currentIdx].type;
            if (choice === 'A') score[type[0]]++;
            else score[type[1]]++;

            currentIdx++;
            
            // [추가] 0.3초 대기 후 다음 질문으로 (피드백 확인용)
            setTimeout(() => {
                if (currentIdx < questions.length) {
                    showQuestion();
                } else {
                    showResult();
                }
            }, 300);
        }

        function showResult() {
            document.getElementById('question-screen').style.display = 'none';
            document.getElementById('result-screen').style.display = 'block';
            document.getElementById('progress').style.width = "100%";

            document.getElementById('status-text').style.display = 'none';

            const mbti = 
                (score.E >= score.I ? "E" : "I") +
                (score.S >= score.N ? "S" : "N") +
                (score.T >= score.F ? "T" : "F") +
                (score.J >= score.P ? "J" : "P");

            const result = results[mbti] || { title: "정예 퇴마사", weapon: "표준 퇴마 도구", desc: "당신은 블랙테일의 핵심 인재입니다." };
            
            document.getElementById('result-title').innerText = result.title;
            document.getElementById('result-weapon').innerText = "주력 영구: " + result.weapon;
            document.getElementById('result-desc').innerText = result.desc;
        }

        function onon() {
            window.location.href = "tools.html";
        }
    </script>
</body>
</html>